<%@ page language="java" contentType="text/html; charset=EUC-KR"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ page import="java.text.SimpleDateFormat" %>
<%@ page import="java.util.Date" %>
<%@ page import="util.BoardStatusConverter" %>

<!DOCTYPE html>
<html>

<style>
    /* CSS for mouseover effect on table rows */
    tbody tr:hover {
        background-color: #f5f5f5; /* Change this to your desired hover color */
    }

    /* CSS for mouseover effect on table cells */
    tbody td:hover {
        background-color: #e0e0e0; /* Change this to your desired hover color */
    }
</style>


<head>

<meta charset="EUC-KR">
<title>Login Success</title>
</head>
<body>
	<%-- Check if session attributes are present --%>
	<c:if test="${empty sessionScope.loggedInUserId}">
		<%-- Redirect to payLogin.jsp if session attributes are not present --%>
		<% response.sendRedirect(request.getContextPath() + "/payLogin.jsp"); %>
	</c:if>

	<h1>로그인 성공</h1>
	<%
    // 세션에서 로그인한 사용자의 정보를 가져옵니다.
    String loggedInUserId = (String) session.getAttribute("loggedInUserId");
    String loggedInUserName = (String) session.getAttribute("loggedInUserName");
    String loggedInUserRank = (String) session.getAttribute("loggedInUserRank");
%>



	<div id="head">
		<h3><%= loggedInUserName %>(<%= loggedInUserRank %>) 님 환영합니다
		</h3>
		<form action="logout" method="post">
			<button type="submit">로그아웃</button>
		</form>

		<c:choose>
			<c:when
				test="${loggedInUserRank eq '과장' or loggedInUserRank eq '부장'}">
				<button>대리 결재</button>
			</c:when>
			<c:otherwise>
				<%-- Do nothing or display alternative content for other ranks --%>
			</c:otherwise>
		</c:choose>

		<div>
			<form action="payWriteForm" method="get">
				<input type="hidden" name="id" value="${loggedInUserId}"> <input
					type="hidden" name="userName" value="${loggedInUserName}">
				<input type="hidden" name="userRank" value="${loggedInUserRank}">
				<button type="submit">글쓰기</button>
			</form>

		</div>
	</div>

	<!-- 검색창 부분 -->
	<form action="search" method="get">
		<select name="searchType">
			<option value="all">선택</option>
			<option value="writer">작성자</option>
			<option value="approver">결재자</option>
			<option value="titleContent">제목+내용</option>
		</select> <input type="text" name="searchKeyword" placeholder="검색어 입력">

		<!-- 추가: 결재상태 드롭다운 메뉴 -->
		<select name="approveStatus">
			<option value="">결재상태</option>
			<option value="temporary">임시저장</option>
			<option value="waiting">결재대기</option>
			<option value="inProgress">결재중</option>
			<option value="completed">결재완료</option>
			<option value="rejected">반려</option>
		</select>

		<button type="submit">검색</button>
	</form>


	<!-- 보드 리스트 부분 -->
	<table border="1">
		<thead>
			<tr>
				<th>번호</th>
				<th>작성자</th>
				<th>제목</th>
				<th>작성일</th>
				<th>결재일</th>
				<th>결재자</th>
				<th>결재상태</th>
			
				
			</tr>
		</thead>
		<tbody>
	

		<%-- 여기에 서버에서 가져온 보드 리스트 데이터를 반복해서 출력하는 부분이 들어갑니다. --%>
			<c:forEach var="board" items="${boardList}">
		    <tr>
		        <td>${board.seq}</td>
		        <td>${board.memName}</td>
		        <td>${board.subject}</td>
		        <td>${board.regDate.time}</td>
		        <td>${board.checkDate.time}</td>
		        <td>${board.checkName}</td>
		        <td>${BoardStatusConverter.getKoreanStatus(board.payOption)}</td>
		    </tr>
		</c:forEach>


			
		</tbody>
	</table>
	
	<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Get all table rows
        var rows = document.querySelectorAll('tbody tr');

        // Add click event listener to each row
        rows.forEach(function (row) {
            row.addEventListener('click', function () {
                // Get the URL you want to navigate to (replace with your URL)
                var detailUrl = 'your_detail_page_url';

                // Navigate to the detail page
                window.location.href = detailUrl;
            });
        });
    });
</script>
	

</body>
</html>
